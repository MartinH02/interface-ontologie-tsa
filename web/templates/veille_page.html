<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse de Veille - Suivi et Rapports</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .veille-container {
            padding: 2rem 0;
        }
        
        .veille-header {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .veille-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .veille-header p {
            color: var(--text-secondary);
        }
        
        /* Tabs */
        .tabs-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
        }
        
        .tabs-header {
            display: flex;
            background: var(--bg-card-hover);
            border-bottom: 1px solid var(--border-color);
        }
        
        .tab-button {
            flex: 1;
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button:hover {
            background: var(--bg-card);
            color: var(--text-primary);
        }
        
        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: var(--bg-card);
        }
        
        .tab-content {
            display: none;
            padding: 2rem;
            min-height: 70vh;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Notion iframe */
        .notion-wrapper {
            width: 100%;
            height: 70vh;
            min-height: 600px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .notion-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }
        
        /* PDF viewer */
        .pdf-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 1rem;
        }
        
        .pdf-card {
            background: var(--bg-card-hover);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }
        
        .pdf-card h3 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }
        
        .pdf-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            flex-grow: 1;
        }
        
        .pdf-viewer {
            width: 100%;
            height: 600px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: white;
        }
        
        .pdf-link {
            display: inline-block;
            background: var(--gradient-1);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }
        
        .pdf-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }
        
        .notion-fallback {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }
        
        @media (max-width: 768px) {
            .tabs-header {
                flex-direction: column;
            }
            
            .tab-button {
                border-bottom: 1px solid var(--border-color);
                border-right: none;
            }
            
            .tab-button.active {
                border-bottom-color: var(--border-color);
                border-left: 3px solid var(--primary-color);
            }
            
            .pdf-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">üìä Analyse de Veille</h1>
                <p class="subtitle">Suivi et Rapports de Veille Technologique</p>
            </div>
        </div>
    </header>

    <!-- Veille Page -->
    <section class="veille-section">
        <div class="container">
            <div class="veille-header">
                <h1>üìö Veille Technologique</h1>
                <p>Suivez l'√©volution de la veille et consultez les rapports</p>
            </div>
            
            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-button active" onclick="switchTab('suivi')">
                        üìù Suivi de Veille
                    </button>
                    <button class="tab-button" onclick="switchTab('rapport')">
                        üìÑ Rapport de Veille
                    </button>
                </div>
                
                <!-- Onglet Suivi de Veille -->
                <div id="tab-suivi" class="tab-content active">
                    <h2 style="color: var(--text-primary); margin-bottom: 1rem;">Suivi de Veille</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                        Suivez l'√©volution de votre veille technologique en temps r√©el via Notion.
                    </p>
                    
                    {% if notion_url %}
                    <div class="notion-wrapper">
                        <iframe 
                            src="{{ notion_url }}" 
                            width="100%" 
                            height="600" 
                            frameborder="0" 
                            allowfullscreen
                            class="notion-iframe"
                            loading="lazy">
                        </iframe>
                    </div>
                    {% else %}
                    <div class="notion-fallback">
                        <h3>Configuration requise</h3>
                        <p>Veuillez configurer l'URL Notion dans <code>web/app.py</code></p>
                    </div>
                    {% endif %}
                </div>
                
                <!-- Onglet Rapport de Veille -->
                <div id="tab-rapport" class="tab-content">
                    <h2 style="color: var(--text-primary); margin-bottom: 1rem;">Rapport de Veille</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                        Consultez les rapports de contexte et le rapport final de veille.
                    </p>
                    
                    <div class="pdf-container">
                        <!-- Rapport de Contexte -->
                        {% if has_contexte %}
                        <div class="pdf-card">
                            <h3>üìã Rapport de Contexte de Veille</h3>
                            <p>Premier rapport d√©finissant le contexte et les objectifs de la veille technologique sur l'apport des technologies NLP et des outils num√©riques dans l'accompagnement des personnes atteintes de TSA.</p>
                            <iframe 
                                src="{{ url_for('serve_pdf', filename='IA03_Veille_contexte.pdf') }}#toolbar=1" 
                                class="pdf-viewer"
                                type="application/pdf">
                            </iframe>
                            <a href="{{ url_for('serve_pdf', filename='IA03_Veille_contexte.pdf') }}" target="_blank" class="pdf-link">
                                Ouvrir dans un nouvel onglet ‚Üí
                            </a>
                        </div>
                        {% endif %}
                        
                        <!-- Rapport Final de Veille -->
                        {% if has_rapport %}
                        <div class="pdf-card">
                            <h3>üìä Rapport Final de Veille</h3>
                            <p>Rapport complet de l'analyse de veille avec les m√©thodes de collecte, la structuration du flux d'articles, la mise en place de l'ontologie et l'√©valuation des r√©sultats.</p>
                            <iframe 
                                src="{{ url_for('serve_pdf', filename='IA03_Rapport_de_veille.pdf') }}#toolbar=1" 
                                class="pdf-viewer"
                                type="application/pdf">
                            </iframe>
                            <a href="{{ url_for('serve_pdf', filename='IA03_Rapport_de_veille.pdf') }}" target="_blank" class="pdf-link">
                                Ouvrir dans un nouvel onglet ‚Üí
                            </a>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="veille-actions" style="margin-top: 2rem; text-align: center;">
                <a href="{{ url_for('index') }}" class="back-btn">‚Üê Retour √† l'accueil</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Veille Technologique - IA03 - Groupe 4</p>
            <p>Naya Mattar, Martin Halbourg</p>
        </div>
    </footer>

    <script>
        function switchTab(tabName) {
            // Masquer tous les contenus
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // D√©sactiver tous les boutons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Afficher le contenu s√©lectionn√©
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Activer le bouton correspondant
            event.target.classList.add('active');
        }
    </script>
</body>
</html>

